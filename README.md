CVE Consumer Application
==========================

Database Migration
-----------------

### Database Setup

* The application uses a PostgreSQL database named `cve` with a schema named `cve`.
* The database is set up using zero-downtime database migrations with Flyway or Liquibase.
* Migration files are written for all DDL SQL statements that CREATE, ALTER, or DROP database objects.

### Migration Scripts

* The migration scripts are idempotent, meaning re-running migrations that are already applied is a no-op.
* The scripts are run using an init container.

Application Implementation
---------------------------

### Kafka Consumer

* The application consumes messages from the Kafka topic `cve`.
* Duplicate Kafka messages are detected and ignored, with ignored messages logged.

### Database Storage

* CVEs are stored in the PostgreSQL database using the JSON data type.
* Proper indexes are implemented on the JSON data type column.
* The database model supports versioning of CVEs, allowing for querying of all versions/updates of CVEs.

### Application Behavior

* The application continues to run even if there are no messages on the Kafka topic to be consumed.

Container Image
---------------

* A Jenkins job is used to build and publish a multi-platform container image for the web application to Docker Hub.
* The Docker repository and container image are private.
* A webhook is configured to trigger the Jenkins job.
* Semver versioning is used for the container tags.
* All configuration and credentials for the migration script are provided by environment variables.

Environment Variables
---------------------

* The following environment variables are used to configure the application:
	+ `DB_HOST`
	+ `DB_PORT`
	+ `DB_USERNAME`
	+ `DB_PASSWORD`
	+ `KAFKA_TOPIC`
	+ `KAFKA_BROKER`

Getting Started
---------------

* To run the application, simply start the container using the published image.
* The database migration will run automatically, setting up the database without manual intervention.